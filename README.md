# Анализ авиаперевозок по России

Для проекта взята БД авиаперевозок по России за год с
[postgrespro.ru](https://postgrespro.ru/education/demodb)

## Ссылка на Dashboard Dashboard [PowerBI](https://drive.google.com/drive/folders/1be3vZeNirj1df60Pg2YgYYXLLItOIsfn?usp=drive_link)

<image src="./structure/structure_bd.jpg" alt="Схема БД">

## Использованные технологии

- База данных - PostgresQL
- Расчет метрик выполнен с помощью SQL-запросов
- Визуализация данных - Tableu

## Описание проекта

Будем рассматривать такие сферы авиаперевозок как:

1. Финансовая:

    1.1 - Выручка компании;

    1.2 - Объем продаж.

2. Техническая:

    2.1 - Статусы вылета самолетов;

    2.2 - Причины задержки рейсов;

    2.3 - Наиболее производительная модель самолета.

3. Социальная:

    3.1 - Наиболее популярный маршрут вылета;

    3.2 - Наиболее популярный класс перелета;

    3.3 - Наиболее популярный город прилета/вылета.

**Финансовая часть**

Анализируя финансовую часть, рассмотрим выручку компании и объем продаж. При этом ответим на вопросы:

1. Как изменялась динамика выручки компании?
2. Как изменялась динамика продажи билетов?
3. Как изменялась средняя стоимость билетов?
4. Влияет ли средняя стоимость билетов на выручку компании?
5. Какой класс билетов приносит больше всего выручки компании?

Выручку и количество проданных билетов, необходимо смотреть в разрезе класса полета а именно:

    1. Бизнес;
    2. Комфорт;
    3. Эконом.
 

**График "Динамика выручки"**

<image src="./img//dynamics/Dynamics_revenue.png" alt="Динамика выручки"> 

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Dynamics_revenue/Dynamics_revenue)

[Сслыка на SQL Запрос](https://github.com/cnegaa/transportation/blob/master/sql/dynamics/dynamics_revenue.sql)


**График "Динамика продаж"**

<image src="./img//dynamics/Dynamics_ticket_sales.png" alt="Динамика продажи билетов">

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Dynamics_ticket_sales_16820940884350/Dynamics_ticket_sales)

[Сслыка на SQL Запрос](https://github.com/cnegaa/transportation/blob/master/sql/dynamics/dynamics_ticket_sales.sql)

**Вывод**
Анализ графиков "Динамика выручки" и "Динамика продаж" позволяет сделать следующие выводы:

    1. Динамика выручки и динамика продаж имеют тенденицию к росту по всем классам перелета, при этом имеет небольшие колебания, такие как рост в летние месяцы. При этом, выручка авиаперевозок с начала года изменилась незначительно, а именно:

     -"Эконом" увеличилась на 2 056,00 тыс. руб. или на 0,02%,
     -"Комфорт" сократилась на - 1 273,00 тыс. руб. или на 0,04%,
     -"Бизнес" сократилась на - 1 765,00 тыс. руб. или на 0,48%.

    Количество проданных билетов изменилось аналогично выручке так: 
     -"Эконом" увеличилась на 737,00 тыс. руб. или на 0,12%,
     -"Комфорт" сократилась на - 174,00 тыс. руб. или на 0,25%,
     -"Бизнес" сократилась на - 42,00 тыс. руб. или на 0,37%.

    2. Динамика выручки и динамика продаж имеют идентичные колебания, что говорит о постоянстве средней цены билетов.

**График "Объем выручки и продажи билетов"**

<image src="./img//dynamics/Revenue-ticket.png" alt="Объем выручки и продажи билетов">


**Вывод**
Анализируя график объем выручки и продажи билетов можно сказать, что основной доход от авиаперевозок поступает от билетов класса "Эконом". При этом самым менее развитым классом является "Комфорт"

Проведем анализ выручки компании к длительности полета. При этом ответим на вопросы:

1. Какой маршрут имеет наибольшую прибыль на км полета?
2. Какой город является наиболее прибыльным для отправлений и прилетов?
3. Какие маршруты приносят наибольшую прибыль компании? 

**График "Прибыль маршрута на км полета"**

<image src="./img/route_profit_per_km/Route_profit_per_km.png" alt="Прибыль маршрута на км полета"> 

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Route_profit_per_km/Route_profit_per_km)

[Сслыка на SQL Запрос](https://public.tableau.com/app/profile/.25111955/viz/Route_profit_per_km/Route_profit_per_km)
     
     В используемой БД были даны данные координат городов прилета и вылета, для расчета расстояния между координатами (городами) была использована формула "point <@> point" - Выдаёт расстояние в сухопутных милях между точками на поверхности Земли. В SQL запросе мили были переведены в км


**Вывод** 
Из графика "Прибыль маршрута на км полета" видно, что наиболее выгодное соотношение расстояния маршрута и выручки у маршрута "Москва-Новосибирск". При этом городом с самыми выгодными для компании маршрутами является Москва. 

**Техническая часть** 

Анализируя данные, рассмотрим насколько часто задерживаются и откладываются рейсы, и сколько пассажиров определенного класса задержались и прибыли вовремя в течение года.

При этом ответим на вопросы: 
1. Как часто задерживаются рейсы?
2. Сколько пассажиров приехали с задержкой и каким классом они летели?

**График "Статус полета**

<image src="./img/status_flight/Status_flight.png" alt="Статус полета"> 

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Status_flight/Status_flight)

[Сслыка на SQL Запрос](https://github.com/cnegaa/transportation/blob/master/sql/status_flight/status%20flight.sql)

**Вывод** 

Из графика "Статус полета" видно, что большенство самолетов доходит до точки назначения без задержек

Рассмотрим статусы прилета самолета в соотношении с классом перелета пассажиров.

**График "Статус полета по классам билетов**

<image src="./img/status_flight/Status_flight_class.png" alt="Статус полета по классам билетов">

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Status_flight_class/Status_flight_class)

[Сслыка на SQL Запрос](https://github.com/cnegaa/transportation/blob/master/sql/status_flight/status%20flight.sql)

**Вывод**

Из графика "Статус полета по классам билетов"
Классы билетов в рейсах со статусом "Delayed" составляют: 
- 11,27% класс Business; 
- 1,67% класс Comfort; 
- 88,73% класс Economy.

**Техническая часть**
Проанализируем задержки самолета и факторы влияющие на них, при этом ответим на вопросы:
1. Насколько максимально (мин) задерживается самолет?
2. Влияет ли заполняемость самолета на его задержку?
3. Влияет ли длительность полета на задержку?
4. Какие модели самолета больше всего задерживаются?

**График "Задержки рейсов"**

<image src="./img/flight_delays/Flight_delays.png" alt="Задержки рейсов">

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Flight_delays_16820201019770/Flight_delays)

[Сслыка на SQL Запрос](https://github.com/cnegaa/transportation/tree/master/sql/route_demand)

**Вывод**  

Проанализируем рейсы, которые задерживались на более чем 15 минут, из графика "Задержки рейсов" видно, что Аэробус А-319-100, задерживался на расстоянии 62% от максимально длительного, а Боинг 767-300 в среднем на 50%. 
При этом, заполняемость самолета не имеет определенной тенденции. 
В совокупности эти 2 показателя показывают что длительность перелета и заполняемость самолета пассажирами, не влияет на его задержку. 
При этом, из дынных запроса видно, что Аэробус А-319-100 совершал все задерживаемые рейсы в или с аэропорта " Хомутово", а Боинг 767-300 "Хабаровск-Новый". Что может говорить о таких причинах задержки как особенность маршрута или аэропорта и требует более детального анализа.

**Социальная часть**

Определим наиболее популярный город и маршрут при этом ответим на вопросы:
1. Самый популярный маршрут?
2. Самый популярный город прилета/вылета?

**Популярность маршрутов**

<image src="./img/route_demand/Route_demand.png" alt="Популярность маршрутов">

[Сслыка на tableau.com](https://public.tableau.com/app/profile/.25111955/viz/Route_demand/Route_demand)

[Сслыка на SQL Запрос](https://github.com/cnegaa/transportation/blob/master/sql/route_demand/demand_route.sql)

**Вывод**   
Из графика видно, что самым популярным городом вылета и прилета является Москва. Самый популярный маршрут это - Москва Новосибирск, за год этим маршрутоп пролетело 130 тыс. человек